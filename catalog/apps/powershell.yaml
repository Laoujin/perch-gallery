type: app
name: PowerShell
kind: dotfile
category: Development/Languages
tags: [shell, cli, microsoft, scripting]
description: Cross-platform task automation and configuration management
profiles: [developer, power-user]
os: [windows, linux, macos]
license: MIT
suggests: [bat, eza, fd, fzf, lsd, ripgrep, sd, glow, navi, tokei, zoxide, atuin]
links:
  website: https://learn.microsoft.com/en-us/powershell/
  docs: https://learn.microsoft.com/en-us/powershell/scripting/overview
  github: https://github.com/PowerShell/PowerShell
install:
  winget: Microsoft.PowerShell
  choco: powershell-core
config:
  links:
    - source: profile.ps1
      target:
        windows: "%USERPROFILE%/Documents/PowerShell/Microsoft.PowerShell_profile.ps1"
        linux: "$HOME/.config/powershell/Microsoft.PowerShell_profile.ps1"
        macos: "$HOME/.config/powershell/Microsoft.PowerShell_profile.ps1"
tweaks:
  - id: enable-module-logging
    name: Enable Module Logging
    description: Enable logging for all PowerShell modules
    reversible: true
    registry:
      - key: HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging
        name: EnableModuleLogging
        value: 1
        type: dword
        default-value: null
      - key: HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging\ModuleNames
        name: "*"
        value: "*"
        type: string
        default-value: null
  - id: enable-script-logging
    name: Enable Script Logging
    description: Enable logging for all PowerShell scripts
    reversible: true
    registry:
      - key: HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
        name: EnableScriptBlockLogging
        value: 1
        type: dword
        default-value: null
