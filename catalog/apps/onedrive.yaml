type: app
name: OneDrive
category: Utilities/Storage
tags: [cloud, storage, sync, microsoft]
description: Cloud storage and file synchronization service by Microsoft
profiles: [casual]
os: [windows, macos]
license: proprietary
links:
  website: https://onedrive.live.com
install:
  winget: Microsoft.OneDrive
tweaks:
  - id: disable-autostart
    name: Disable Auto-Start
    description: Prevent OneDrive from launching at Windows startup
    reversible: true
    registry:
      - key: HKCU\Software\Microsoft\Windows\CurrentVersion\Run
        name: OneDrive
        value: null
        type: string
        default-value: null
  - id: disable-file-explorer-ads
    name: Disable File Explorer Ads
    description: Disable OneDrive sync provider notifications in File Explorer
    reversible: true
    registry:
      - key: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
        name: ShowSyncProviderNotifications
        value: 0
        type: dword
        default-value: null
  - id: hide-navigation-pane
    name: Hide from Navigation Pane
    description: Hide the OneDrive icon from the Explorer navigation pane
    reversible: true
    script: |
      $path = 'HKCR:\CLSID\{8E74D236-7F35-4720-B138-1FED0B85EA75}\ShellFolder'
      Set-ItemProperty -Path $path -Name 'Attributes' -Value 0xF090004D -Type DWord
    undo-script: |
      $path = 'HKCR:\CLSID\{8E74D236-7F35-4720-B138-1FED0B85EA75}\ShellFolder'
      Set-ItemProperty -Path $path -Name 'Attributes' -Value 0xF080004D -Type DWord
